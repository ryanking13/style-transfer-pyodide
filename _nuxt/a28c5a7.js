(window.webpackJsonp=window.webpackJsonp||[]).push([[7,4,5,6],{264:function(e,t,r){var content=r(268);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(105).default)("f45b8640",content,!0,{sourceMap:!1})},265:function(e,t,r){var content=r(270);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(105).default)("e05c5d74",content,!0,{sourceMap:!1})},267:function(e,t,r){"use strict";r(264)},268:function(e,t,r){var n=r(104)(!1);n.push([e.i,".github-corner:hover .octo-arm{-webkit-animation:octocat-wave .56s ease-in-out;animation:octocat-wave .56s ease-in-out}@-webkit-keyframes octocat-wave{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@keyframes octocat-wave{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{-webkit-animation:none;animation:none}.github-corner .octo-arm{-webkit-animation:octocat-wave .56s ease-in-out;animation:octocat-wave .56s ease-in-out}}",""]),e.exports=n},269:function(e,t,r){"use strict";r(265)},270:function(e,t,r){var n=r(104)(!1);n.push([e.i,'body{background:#f3f4f5;height:100%;color:#646c7f;line-height:1.4rem;font-family:Roboto,"Open Sans",sans-serif;font-size:20px;font-weight:300;text-rendering:optimizeLegibility}.dropzone{background:#fff;border-radius:5px;border:2px dashed #3372f5;-o-border-image:none;border-image:none;max-width:500px;margin:30px auto}#dropzone .dz-preview{width:160px;display:none}#dropzone .dz-message{display:block}',""]),e.exports=n},271:function(e,t,r){"use strict";r.r(t);r(267);var n=r(45),component=Object(n.a)({},(function(){var e=this.$createElement,t=this._self._c||e;return t("a",{staticClass:"github-corner",attrs:{href:"https://github.com/ryanking13/style-transfer-pyodide","aria-label":"View source on Github"}},[t("svg",{staticStyle:{fill:"#151513",color:"#fff",position:"absolute",top:"0",border:"0",right:"0"},attrs:{width:"80",height:"80",viewBox:"0 0 250 250","aria-hidden":"true"}},[t("path",{attrs:{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}}),t("path",{staticClass:"octo-arm",staticStyle:{"transform-origin":"130px 106px"},attrs:{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor"}}),t("path",{staticClass:"octo-body",attrs:{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor"}})])])}),[],!1,null,null,null);t.default=component.exports},283:function(e,t,r){var content=r(332);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(105).default)("063cec11",content,!0,{sourceMap:!1})},284:function(e,t,r){"use strict";r.r(t);var n=r(273),o=r.n(n),c=(r(274),{components:{Dropzone:o.a},props:{onAdd:{type:Function,default:function(){}}},data:function(){return{dropzoneOptions:{url:"http://localhost",createImageThumbnails:!1,autoProcessQueue:!1,thumbnailWidth:null,thumbnailHeight:null}}},mounted:function(){this.$refs.el.dropzone}}),d=(r(269),r(45)),component=Object(d.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("dropzone",{ref:"el",attrs:{id:"dropzone",options:e.dropzoneOptions,useCustomSlot:!0,"include-styling":!0},on:{"vdropzone-file-added":e.onAdd}},[r("h3",{staticClass:"dropzone-custom-title"},[e._v("\n    Click to upload Image\n  ")])])}),[],!1,null,null,null);t.default=component.exports},285:function(e,t,r){"use strict";r.r(t);var n={props:["message","active"]},o=r(45),component=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("sui-dimmer",{attrs:{active:e.active,inverted:""}},[r("sui-loader",{attrs:{size:"large"}},[e._v("\n      "+e._s(e.message)+"\n  ")])],1)}),[],!1,null,null,null);t.default=component.exports},331:function(e,t,r){"use strict";r(283)},332:function(e,t,r){var n=r(104)(!1);n.push([e.i,".container[data-v-7b33ed62]{max-width:100%;min-height:80vh;display:flex;justify-content:center;align-items:center;text-align:center}.subcontainer[data-v-7b33ed62]{max-width:100%;margin-top:10px;margin-bottom:15px}img[data-v-7b33ed62]{max-width:40%;height:auto;width:auto}",""]),e.exports=n},333:function(e,t,r){"use strict";r.r(t);var n=r(22),o=r(10),c=(r(59),r(286),r(109),r(18),r(36),r(37),r(289),r(184),r(271)),d=r(284),l=r(285);function f(e,t,r,n){return m.apply(this,arguments)}function m(){return(m=Object(o.a)(regeneratorRuntime.mark((function e(t,r,n,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,c){var d=new MessageChannel;d.port1.onmessage=function(t){var data=t.data;d.port1.close(),data.error?c(data.error):e(data.results)};var l=[d.port2];void 0!==o&&(l=l.concat(o)),t.postMessage({action:r,message:n},l)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=Object(o.a)(regeneratorRuntime.mark((function e(t,script){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f(t,"runPython",script));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(){return(v=Object(o.a)(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f(t,"unpack",{buffer:r,format:"gztar"},[r]));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=Object(o.a)(regeneratorRuntime.mark((function e(t,path,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f(t,"readFile",{path:path,type:r}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return(w=Object(o.a)(regeneratorRuntime.mark((function e(t,path,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f(t,"writeFile",{path:path,buffer:r}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x={sendMessage:f,runScript:function(e,t){return h.apply(this,arguments)},unpack:function(e,t){return v.apply(this,arguments)},readFile:function(e,t,r){return y.apply(this,arguments)},writeFile:function(e,t,r){return w.apply(this,arguments)}};r(294),r(295),r(297),r(301),r(303),r(304),r(305),r(308),r(309),r(310),r(311),r(312),r(313),r(314),r(315),r(317),r(318),r(319),r(320),r(321),r(322),r(323),r(324),r(328),r(329),r(330),r(30),r(85);function k(){return(k=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return r=e.sent,e.next=5,r.arrayBuffer();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(){return(R=Object(o.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var i=new Image;i.onload=function(){e({w:i.naturalWidth,h:i.naturalHeight})},i.src=t})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _={convertDataURIToBinary:function(e){return Uint8Array.from(atob(e.replace(/^data[^,]+,/,"")),(function(e){return e.charCodeAt(0)}))},downloadResource:function(e){return k.apply(this,arguments)},getImageDimensions:function(e){return R.apply(this,arguments)}};var z={name:"IndexPage",data:function(){return{pyodideWorker:null,pyodideLoaded:!1,isLoading:!1,loadingMessage:"",resize:!1,style:"mosaic"}},components:{GithubRibbon:c.default,Upload:d.default,Loading:l.default},methods:{setLoading:function(e){this.isLoading=e},setLoadingMessage:function(e){this.loadingMessage=e.trim()},onImageAdd:function(e){var t=this,r=new FileReader;r.onload=function(e){t.runInference(e.target.result)},r.readAsDataURL(e)},runInference:function(img){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.getImageDimensions(img);case 2:return r=t.sent,t.next=5,e.saveImage(img,"image.jpg");case 5:return t.prev=5,t.next=8,e.stylize("image.jpg",r);case 8:n=t.sent,document.getElementById("image-before").src=img,document.getElementById("image-after").src=n,t.next=17;break;case 13:t.prev=13,t.t0=t.catch(5),e.setLoading(!1),console.error(t.t0);case 17:case"end":return t.stop()}}),t,null,[[5,13]])})))()},saveImage:function(img,path){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=_.convertDataURIToBinary(img),t.next=3,x.writeFile(e.pyodideWorker,path,r);case 3:case"end":return t.stop()}}),t)})))()},downloadSampleImage:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.runScript(e.pyodideWorker,'\n        from pyodide.http import pyfetch\n        response = await pyfetch("https://raw.githubusercontent.com/rrmina/fast-neural-style-pytorch/master/images/up-diliman.jpg")\n        if response.status == 200:\n          with open("image.jpg", "wb") as f:\n            f.write(await response.bytes())\n        ');case 2:case"end":return t.stop()}}),t)})))()},stylize:function(e,t){var r=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,data,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.setLoading(!0),r.setLoadingMessage("Running stylization..."),t.w*t.h>1e6&&r.setLoadingMessage("\n          Running stylization...\n          (If the image is large, it can take 1~2 minutes)\n        "),o=r.resize?500:1500,n.next=6,x.runScript(r.pyodideWorker,'\n        img = stylize.stylize("'.concat(e,'", ').concat(o,')\n        cv.imwrite("image_stylized.jpg", img)\n        '));case 6:return n.next=8,x.readFile(r.pyodideWorker,"image_stylized.jpg","image/jpeg");case 8:return data=n.sent,c=window.URL.createObjectURL(data),r.setLoading(!1),n.abrupt("return",c);case 12:case"end":return n.stop()}}),n)})))()},setStyle:function(style){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={mosaic:"mosaic.onnx",udnie:"udnie.onnx"}[style],t.next=3,x.runScript(e.pyodideWorker,'stylize.initialize_network("'.concat(r,'")'));case 3:e.style=style;case 4:case"end":return t.stop()}}),t)})))()},init:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.pyodideLoaded=!1,e.setLoading(!0),e.setLoadingMessage("(1 / 2) Loading Pyodide..."),e.pyodideWorker=e.$worker.createWorker(),t.next=6,Promise.all([_.downloadResource("style_transfer.tar.gz"),x.runScript(e.pyodideWorker,"\n          import cv2 as cv\n          ")]);case 6:return r=t.sent,o=Object(n.a)(r,2),c=o[0],o[1],e.setLoadingMessage("(2 / 2) Loading model..."),t.next=13,x.unpack(e.pyodideWorker,c);case 13:return t.next=15,x.runScript(e.pyodideWorker,"\n        import stylize\n        ");case 15:return t.next=17,e.setStyle(e.style);case 17:e.setLoading(!1),e.pyodideLoaded=!0;case 19:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,e.init();case 3:case"end":return t.stop()}}),t)})))()}},C=(r(331),r(45)),component=Object(C.a)(z,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("loading",{attrs:{active:!0===e.isLoading,message:e.loadingMessage}}),e._v(" "),r("github-ribbon"),e._v(" "),r("section",{staticClass:"container"},[r("div",[r("div",[r("sui-header",{tag:"h1",attrs:{color:"blue","text-align":"center"}},[e._v("\n          Pyodide style transfer playground\n        ")]),e._v(" "),r("upload",{attrs:{onAdd:e.onImageAdd}})],1),e._v(" "),r("div",{staticClass:"subcontainer"},[r("sui-button-group",[r("sui-button",{attrs:{color:"mosaic"===e.style?"blue":"grey",active:"mosaic"===e.style},on:{click:function(t){return e.setStyle("mosaic")}}},[e._v("Style: Mosaic")]),e._v(" "),r("sui-button-or"),e._v(" "),r("sui-button",{attrs:{color:"udnie"===e.style?"blue":"grey",active:"udnie"===e.style},on:{click:function(t){return e.setStyle("udnie")}}},[e._v("Style: Udnie")])],1)],1),e._v(" "),r("div",{staticClass:"subcontainer"},[r("sui-checkbox",{attrs:{label:"Resize Image (makes inference faster)",toggle:""},model:{value:e.resize,callback:function(t){e.resize=t},expression:"resize"}})],1),e._v(" "),e._m(0)])])],1)}),[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("img",{attrs:{id:"image-before",src:"",alt:""}}),e._v(" "),r("img",{attrs:{id:"image-after",src:"",alt:""}})])}],!1,null,"7b33ed62",null);t.default=component.exports;installComponents(component,{GithubRibbon:r(271).default})}}]);